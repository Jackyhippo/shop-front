import{S as R,ae as S,ad as A,R as E,G as I,c as g,Y as n,$ as h,X as s,L as a,aw as y,ai as u,W as C,_ as q,O as b,af as i,ag as p,aR as z,V as D,aj as P,am as j}from"./index-CJ02KohQ.js";import{V as m,a as F,b as w}from"./route-block-Cm0x37ow.js";import{V as x}from"./VDivider-rWzU1HUO.js";import{V as G,a as O}from"./VList-B2ZwaDLV.js";import{V as T}from"./VContainer-BKHYJw0a.js";const U={class:"text-center"},W={class:"text-center"},X={__name:"cart",setup(Y){const{apiAuth:d}=j(),_=R(),B=S(),f=A(),{t:k}=E(),c=I([]),V=async()=>{try{const{data:e}=await d.get("/user/cart");c.value=e.result}catch(e){console.log(e)}};V();const $=g(()=>c.value.reduce((e,r)=>e+r.product.price*r.quantity,0)),L=g(()=>c.value.length>0&&c.value.every(e=>e.product.sell)),v=async(e,r)=>{var t,l;try{const{data:o}=await d.patch("/user/cart",{product:e,quantity:r});_.cart=o.result,V()}catch(o){console.log(o),f({text:k("api."+(((l=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:l.message)||"unknownError")),snackbarProps:{color:"red"}})}},N=async()=>{var e,r;try{await d.post("/order"),_.cart=0,B.push("/orders")}catch(t){console.log(t),f({text:k("api."+(((r=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(e,r)=>(n(),h(T,null,{default:s(()=>[a(F,null,{default:s(()=>[a(m,{cols:"12"},{default:s(()=>[y("h1",U,u(e.$t("nav.cart")),1)]),_:1}),a(x),a(m,{cols:"12"},{default:s(()=>[a(G,{lines:"two"},{default:s(()=>[(n(!0),C(b,null,q(c.value,(t,l)=>(n(),C(b,{key:t._id},[a(O,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-red",active:!t.product.sell},{prepend:s(()=>[a(z,{rounded:"0"},{default:s(()=>[a(D,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[a(i,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:o=>v(t.product._id,-1)},{default:s(()=>r[0]||(r[0]=[p("-")])),_:2},1032,["onClick"]),p(" "+u(t.quantity)+" ",1),a(i,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:o=>v(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),l<c.value.length-1?(n(),h(x,{key:0})):P("",!0)],64))),128))]),_:1})]),_:1}),a(m,{cols:"12",class:"text-center"},{default:s(()=>[y("p",W,u($.value),1),a(i,{color:"primary",disabled:!L.value,onClick:N},{default:s(()=>[p(u(e.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof w=="function"&&w(X);export{X as default};
